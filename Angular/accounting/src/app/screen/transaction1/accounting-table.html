<div class="accounting-container">
  <div class="header">
    <h2>Journal Entry</h2>
    <button mat-raised-button color="primary" (click)="addRow()">
      <mat-icon>add</mat-icon>
      Add Row
    </button>
  </div>

  <div class="table-container">
    <table mat-table [dataSource]="dataSource" class="accounting-table">
      
      <!-- Type Column -->
      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field appearance="outline" class="full-width">
            <mat-select [(ngModel)]="element.type">
              <mat-option *ngFor="let type of accountTypes" [value]="type">
                {{ type }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Account Column -->
      <ng-container matColumnDef="account">
        <th mat-header-cell *matHeaderCellDef>Account</th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field appearance="outline" class="full-width">
            <input 
              matInput 
              [(ngModel)]="element.account" 
              placeholder="Enter account name"
            />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Amount Column -->
      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef>Amount</th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field appearance="outline" class="full-width">
            <input 
              matInput 
              type="number" 
              [(ngModel)]="element.amount" 
              placeholder="0.00"
              min="0"
              step="0.01"
            />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Narration Column -->
      <ng-container matColumnDef="narration">
        <th mat-header-cell *matHeaderCellDef>Narration</th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field appearance="outline" class="full-width">
            <input 
              matInput 
              [(ngModel)]="element.narration" 
              placeholder="Enter narration"
            />
          </mat-form-field>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let element">
          <button 
            mat-icon-button 
            color="warn" 
            (click)="deleteRow(element.id)"
            matTooltip="Delete row"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <!-- Summary Section -->
  <div class="summary-section">
    <div class="summary-row">
      <span class="summary-label">Total Debit:</span>
      <span class="summary-value debit">{{ getTotalDebit() | number:'1.2-2' }}</span>
    </div>
    <div class="summary-row">
      <span class="summary-label">Total Credit:</span>
      <span class="summary-value credit">{{ getTotalCredit() | number:'1.2-2' }}</span>
    </div>
    <div class="summary-row" [class.balanced]="isBalanced()" [class.unbalanced]="!isBalanced()">
      <span class="summary-label">Difference:</span>
      <span class="summary-value">{{ getDifference() | number:'1.2-2' }}</span>
    </div>
    <div class="balance-status" [class.balanced]="isBalanced()" [class.unbalanced]="!isBalanced()">
      <mat-icon>{{ isBalanced() ? 'check_circle' : 'error' }}</mat-icon>
      <span>{{ isBalanced() ? 'Balanced' : 'Not Balanced' }}</span>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button mat-raised-button (click)="clearAll()" color="warn">
      <mat-icon>clear</mat-icon>
      Clear All
    </button>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="onSubmit()"
      [disabled]="!isBalanced() || dataSource.length === 0"
    >
      <mat-icon>save</mat-icon>
      Submit Entry
    </button>
  </div>
</div>
